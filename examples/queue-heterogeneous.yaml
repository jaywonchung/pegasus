# Jobs for heterogeneous cluster.
# Large jobs only fit on high-end servers, small jobs run anywhere.

# 8-GPU job - only fits on a100-server
- command:
    - CUDA_VISIBLE_DEVICES={{slots}} torchrun --nproc_per_node=8 train.py --model xlarge
  slots:
    - 8

# 4-GPU jobs - fit on a100-server or v100-servers
- command:
    - CUDA_VISIBLE_DEVICES={{slots}} torchrun --nproc_per_node=4 train.py --model large
  slots:
    - 4

- command:
    - CUDA_VISIBLE_DEVICES={{slots}} torchrun --nproc_per_node=4 train.py --model large --lr 0.001
  slots:
    - 4

# Single-GPU jobs - fit anywhere with GPUs
- CUDA_VISIBLE_DEVICES={{slots}} python train.py --model small
- CUDA_VISIBLE_DEVICES={{slots}} python train.py --model small --augment

# CPU jobs - fit on CPU servers (or GPU servers if they have free slots)
- python preprocess.py --dataset train
- python preprocess.py --dataset val
- python preprocess.py --dataset test
